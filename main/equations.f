C     ------------------------------------------------------------------
C     Program to solve a system of equations
C     ------------------------------------------------------------------

      program equations
        implicit none

C     ------------------------------------------------------------------
C     Declare the variables, matrix and vectors
C     ------------------------------------------------------------------

        integer, parameter :: n = 4
        integer :: i, j, k

        real  :: A(n, n)
        real  :: X(n)
        real  :: B(n)
        real  :: suma

C     ------------------------------------------------------------------
C     Initialize the matrix and vectors to zero
C     ------------------------------------------------------------------

        A = 0
        X = 0
        B = 0

20    format(4(a, i1))

C     ------------------------------------------------------------------
C     Ask user for Matrix A
C     ------------------------------------------------------------------

        do i=1, n
          do j=1, i
            write(*, 20) 'Enter A(',i, ',', j, ')'
            read(*,*) A(i, j)
          enddo
        enddo
        
C     ------------------------------------------------------------------
C     Write Matrix A to screen for confirmation
C     ------------------------------------------------------------------

        write(*,*) 
        write(*,*) 'Matrix A'
        write(*,*) '--------'
        do i=1, n
          write(*,'(4F7.2)') (A(i, j), j=1, n)
        enddo
        
        write(*,*)

C     ------------------------------------------------------------------
C     Ask user for Vector B
C     ------------------------------------------------------------------

        do i=1, n
            write(*, 20) 'Enter B(',i,')'
            read(*,*) B(i)
        enddo

C     ------------------------------------------------------------------
C     Write Vector B to screen for confirmation
C     ------------------------------------------------------------------

        write(*,*)
        write(*,*) 'Vector B'
        write(*,*) '--------'
        write(*,'(5F7.2)') (B(i), i=1, n)

C     ------------------------------------------------------------------
C     Calculate the Vector X
C     ------------------------------------------------------------------

        do j = 1, n
          suma = 0

          do k = 1, j-1
            suma = suma + (A(j, k) * X(k))
          enddo
          
          X(j) = (B(j) - suma) / A(j,j)
        enddo

C     ------------------------------------------------------------------
C     Write Vector X to screen as the solution
C     ------------------------------------------------------------------

        write(*,*)
        write(*,*) 'Solution'
        write(*,*) '--------'
        write(*,'(5F7.2)') (X(i), i=1, n)
        
      end program equations